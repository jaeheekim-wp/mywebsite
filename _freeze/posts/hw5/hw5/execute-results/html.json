{
  "hash": "223533dcc6bfa2d91c3e8bb13ae9cee6",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: LS 빅데이터 스쿨 HW5\nauthor: 재희\ndate: '2024-07-30'\ncategories:\n  - bigdata\n---\n\n# 해당 그래프에서 성별에 따른  95프로 신뢰 구간을 표시하기.\n\n::: {#0870630b .cell execution_count=1}\n``` {.python .cell-code}\n# !pip install pyreadstat\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n\nraw_welfare=pd.read_spss(\"C:/Users/USER/Documents/LS 빅데이터스쿨/mywebsite/data/plz/Koweps_hpwc14_2019_beta2.sav\")\nraw_welfare\n\nwelfare=raw_welfare.copy()\nwelfare.shape\nwelfare.describe()\n\n# 변수명 변경 \nwelfare=welfare.rename(\n    columns = {\n        \"h14_g3\": \"sex\",\n        \"h14_g4\": \"birth\",\n        \"h14_g10\": \"marriage_type\",\n        \"h14_g11\": \"religion\",\n        \"p1402_8aq1\": \"income\",\n        \"h14_eco9\": \"code_job\",\n        \"h14_reg7\": \"code_region\"\n    })\n\n\nwelfare=welfare[[\"sex\", \"birth\", \"marriage_type\",\n                \"religion\", \"income\", \"code_job\", \"code_region\"]]\nwelfare.shape\n\n# 변수 검토\nwelfare[\"sex\"].dtypes\nwelfare[\"sex\"].value_counts()\n# welfare[\"sex\"].isna().sum()\n\n# 성별 항목 이름 부여 \nwelfare[\"sex\"] = np.where(welfare[\"sex\"] == 1,'male', 'female')\n# 빈도 구하기 \nwelfare[\"sex\"].value_counts()\n\n# income\n\n# welfare[\"income\"].describe()\nwelfare[\"income\"].value_counts()\nwelfare[\"income\"].isna().sum()\n\n# 성별 월급 평균표 구하기 \nsex_income = welfare.dropna(subset=\"income\") \\\n                  .groupby(\"sex\", as_index=False) \\\n                  .agg(mean_income = (\"income\", \"mean\"))\n\nsex_income\n\n# 막대 그래프화 \n\nsns.barplot(data=sex_income, x=\"sex\", y=\"mean_income\",\n            hue=\"sex\")\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-2-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n# 표본평균, 표준편차 구하기 ( groupby+agg로 변수 추가)\n\n::: {#7cc24479 .cell execution_count=2}\n``` {.python .cell-code}\nfrom scipy.stats import norm\n\nsex_income = welfare.dropna(subset=\"income\") \\\n                  .groupby(\"sex\", as_index=False) \\\n                  .agg(mean_income = (\"income\", \"mean\"),\\\n                       std_income = (\"income\", \"std\"),\\\n                       count_income = (\"income\", \"count\"))\n\nsex_income\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>mean_income</th>\n      <th>std_income</th>\n      <th>count_income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>female</td>\n      <td>186.293096</td>\n      <td>132.057402</td>\n      <td>2245</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>male</td>\n      <td>349.037571</td>\n      <td>217.862254</td>\n      <td>2289</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# 성별 간 신뢰구간 변수 추가하기 \n\n::: {#05d4ad06 .cell execution_count=3}\n``` {.python .cell-code}\n# mean +(-) 1.96 * std/sqrt(n) \n\nsex_income[\"left_ci\"] = sex_income[\"mean_income\"] - 1.96 * sex_income[\"std_income\"] / np.sqrt(sex_income[\"count_income\"])\nsex_income[\"right_ci\"] = sex_income[\"mean_income\"] + 1.96 * sex_income[\"std_income\"] / np.sqrt(sex_income[\"count_income\"])\nsex_income\n\n# 1.96 = norm.ppf(0.975, loc=0, scale=1)\n# selected_columns = ['sex','left_ci', 'right_ci']\n# sex_income_ci = sex_income[selected_columns]\n# sex_income_ci\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>mean_income</th>\n      <th>std_income</th>\n      <th>count_income</th>\n      <th>left_ci</th>\n      <th>right_ci</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>female</td>\n      <td>186.293096</td>\n      <td>132.057402</td>\n      <td>2245</td>\n      <td>180.830354</td>\n      <td>191.755837</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>male</td>\n      <td>349.037571</td>\n      <td>217.862254</td>\n      <td>2289</td>\n      <td>340.112428</td>\n      <td>357.962714</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# 그래프 만들기\n\n::: {#f8f33479 .cell execution_count=4}\n``` {.python .cell-code}\nsns.barplot(data=sex_income,x=\"sex\",y=\"mean_income\",hue='sex')\nplt.plot([0, 0], [sex_income.iloc[0][\"left_ci\"], sex_income.iloc[0][\"right_ci\"]], color='red', linewidth=2)\nplt.plot([1, 1], [sex_income.iloc[1][\"left_ci\"], sex_income.iloc[1][\"right_ci\"]], color='blue', linewidth=2)\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-5-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "hw5_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}