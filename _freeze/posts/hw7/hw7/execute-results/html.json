{
  "hash": "08aa90102bf489b943e709b2ef0df56c",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"LS 빅데이터 스쿨 HW7\"\nauthor : \"재희\"\ndate : \"2024-09-02\"\ncategories : [bigdata]\njupyter: python3\n---\n\n# ADP 표본점수\n\n### 2022년에 실시 된 ADP 실기 시험의 통계파트 표준점수는 평균이 30, 표준편차가 5인 정규분포를 따른다고 한다.\n### 1) ADP 실기 시험의 통계파트 표준점수의 밀도함수를 그려보세요.\n\n::: {#29b1dfab .cell execution_count=1}\n``` {.python .cell-code}\n# X ∼ N(30, 5^2)\nimport numpy as np\nfrom scipy.stats import norm\nimport matplotlib.pyplot as plt\n\nx = np.arange(10,50,0.1)\ny = norm.pdf(x, loc = 30, scale = 5)\n\nplt.plot(x, y)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw7_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 2) ADP 수험생을 임의로 1명을 선택하여 통계 점수를 조회했을때 45점 보다 높은 점수를 받았을 확률을 구하세요.\n\n::: {#3b682dee .cell execution_count=2}\n``` {.python .cell-code}\n# P(x>45)\nadp_x = 1 - norm.cdf(45, loc = 30, scale = 5)\nadp_x\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\n0.0013498980316301035\n```\n:::\n:::\n\n\n### 3) 슬통이는 상위 10%에 해당하는 점수를 얻었다고 한다면, 슬통이의 점수는 얼마인지 계산해보세요.\n\n::: {#e5cb8a66 .cell execution_count=3}\n``` {.python .cell-code}\n# P(X>45)\nscore = norm.ppf(0.90, loc=30, scale=5)\nscore\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\n36.407757827723\n```\n:::\n:::\n\n\n### 4) 슬기로운 통계생활의 해당 회차 수강생은 16명이었다고 한다. 16명의 통계 파트 점수를 평균 내었을 때, 이 평균값이 따르는 분포의 확률밀도 함수를 1번의 그래프와 겹쳐 그려보세요.\n\n::: {#bc9b401d .cell execution_count=4}\n``` {.python .cell-code}\n# 표본 평균\n# X_VAR ∼ N(30, 5^2/16)\n\nx = np.arange(10,50,0.1)\ny = norm.pdf(x, loc=30, scale=5)\n\nplt.plot(x, y, color='black')\n\ny2 = norm.pdf(x, loc=30, scale=5/np.sqrt(16))\n\nplt.plot(x, y2, color='red')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw7_files/figure-html/cell-5-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 5) 슬기로운 통계생활 ADP 반 수강생들의 통계점수를 평균내었다고 할 때, 이 값이 38점보다 높게 나올 확률을 구하세요.\n\n::: {#fcddd15c .cell execution_count=5}\n``` {.python .cell-code}\n# 표본 평균\n# X_VAR ∼ N(30, 5^2/16)\n# # P(X_VAR > 38)\n\nadp_score = 1 - norm.cdf(38, loc=30, scale=5/np.sqrt(16))\nadp_score\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\n7.76885222819601e-11\n```\n:::\n:::\n\n\n# Covid 19 발병률\n\n### Covid‑19의 발병률은 1%라고 한다. 다음은 이번 코로나 사태로 인하여 코로나 의심 환자들 1,085명을 대상으로 슬통 회사의 “다잡아” 키트를 사용하여 양성 반응을 체크한 결과이다.\n\n::: {#982cf852 .cell execution_count=6}\n``` {.python .cell-code}\nimport pandas as pd\n\n# 데이터를 Pandas DataFrame으로 생성\ndata = {\n    \"실제 \\\\ 키트\": [\"양성\", \"음성\", \"합계\"],\n    \"양성\": [370, 15, 385],\n    \"음성\": [10, 690, 700],\n    \"합계\": [380, 705, 1085]\n}\n\ndf = pd.DataFrame(data)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>실제 \\ 키트</th>\n      <th>양성</th>\n      <th>음성</th>\n      <th>합계</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>양성</td>\n      <td>370</td>\n      <td>10</td>\n      <td>380</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>음성</td>\n      <td>15</td>\n      <td>690</td>\n      <td>705</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>합계</td>\n      <td>385</td>\n      <td>700</td>\n      <td>1085</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 1) 다잡아 키트가 코로나 바이러스에 걸린 사람을 양성으로 잡아낼 확률을 계산하세요.\n\n::: {#0ad2692c .cell execution_count=7}\n``` {.python .cell-code}\n# P(키트 양성 | 실제 양성)\n370 / 385\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\n0.961038961038961\n```\n:::\n:::\n\n\n### 2) 슬통 회사에서 다잡아 키트를 사용해 양성으로 나온 사람이 실제로는 코로나 바이러스에 걸려있을 확률을 97%라며, 키트의 우수성을 주장했다. 이 주장이 옳지 않은 이유를 서술하세요.\n\n::: {#edbfcd73 .cell execution_count=8}\n``` {.python .cell-code}\n# P(슬통 회사 지표에서 계산된 발병률) = 실제 양성 / 전체 \nresult = 385/1085\n# P(실제 발병률) = 0.01\nreal = 0.01\n\n# 실제 발병률과 지표 내 발병률의 차이가 크기 때문에 우수성 주장은 옳지 않다.\n```\n:::\n\n\n### 3) Covid‑19 발병률을 사용하여, 키트의 결과값이 양성으로 나온 사람이 실제로 코로나 바이러스에걸려있을 확률을 구하세요.\n\n::: {#0c1fc5c0 .cell execution_count=9}\n``` {.python .cell-code}\n# P(실제양성|키트양성)\n# = P(실제양성&키트양성) / P(키트양성)\n# = P(실제양성) * P(키트양성| 실제양성) / P(실제양성) * P(키트양성| 실제양성) + P(실제음성) * P(키트양성)\ncovid_positive = (0.01 * (370 / 385)) / (0.01 * (370 / 385) + 0.99 * (10 / 700))\ncovid_positive\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```\n0.4045926735921268\n```\n:::\n:::\n\n\n# 카이제곱분포와 표본분산\n\n### 자유도가 𝑘인 카이제곱분포를 따르는 확률변수 𝑋 를 𝑋 ∼ 𝜒2(𝑘) 과 같이 나타내고, 이 확률변수의 확률밀도함수는 다음과 같습니다.\n### 𝑓𝑋(𝑥; 𝑘) =1 2𝑘/2Γ(𝑘/2)𝑥𝑘/2−1𝑒−𝑥/2 \n\n### 1) 자유도가 4인 카이제곱분포의 확률밀도함수를 그려보세요.\n\n::: {#0e38654d .cell execution_count=10}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import chi2, norm\n\nk = np.linspace(0, 40, 500)\ny = chi2.pdf(k, df = 4)\nplt.plot(k, y, color = \"red\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw7_files/figure-html/cell-11-output-1.png){width=588 height=411}\n:::\n:::\n\n\n### 2) 다음의 확률을 구해보세요.\n\n::: {#addfb553 .cell execution_count=11}\n``` {.python .cell-code}\n# P (3 ≤ X ≤ 5)\nvalue = chi2.cdf(5, df = 4) - chi2.cdf(3, df = 4)\nvalue\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\n0.27052790518742903\n```\n:::\n:::\n\n\n### 3) 자유도가 4인 카이제곱분포에서 크기가 1000인 표본을 뽑은 후, 히스토그램을 그려보세요.\n\n::: {#a26e2e0d .cell execution_count=12}\n``` {.python .cell-code}\n# 표본 생성\nnp.random.seed(2024)\nchi_x = chi2.rvs(df=4, size=1000)\n\n# 히스토그램 표시\nplt.hist(chi_x, bins=50, density=True, color=\"red\", edgecolor=\"black\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw7_files/figure-html/cell-13-output-1.png){width=598 height=411}\n:::\n:::\n\n\n### 4) 자유도가 4인 카이제곱분포를 따르는 확률변수에서 나올 수 있는 값 중 상위 5%에 해당하는값은 얼마인지 계산해보세요.\n\n::: {#44f4d7be .cell execution_count=13}\n``` {.python .cell-code}\nchi_value = chi2.ppf(0.95, df = 4) \nchi_value\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\n9.487729036781154\n```\n:::\n:::\n\n\n### 5) 3번에서 뽑힌 표본값들 중 상위 5%에 위치한 표본의 값은 얼마인가요?\n\n::: {#d2015846 .cell execution_count=14}\n``` {.python .cell-code}\n# 표본 내에서 상위 5%에 해당하는 값 계산\nthreshold_value = np.percentile(chi_x, 95)\nthreshold_value\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\n10.006310615752485\n```\n:::\n:::\n\n\n### 6) 평균이 3, 표준편차가 2인 정규분포를 따르는 확률변수에서 크기가 20인 표본, 𝑥1, ..., 𝑥20,을뽑은 후 표본분산을 계산한 것을 𝑠21이라 생각해보죠.같은 방법으로 500개의 𝑠2 들, 𝑠21, 𝑠2, ..., 𝑠2500 발생시킵니다.발생한 500개의 𝑠2 들 각각에 4.75를 곱하고, 그것들의 히스토그램을 그려보세요. (히스토그램을 그릴 때 probability = TRUE 옵션을 사용해서 그릴 것) \n### 위에서 그린 히스토그램에 자유도가 19인 카이제곱분포 확률밀도함수를 겹쳐그려보세요.\n\n::: {#53dc0650 .cell execution_count=15}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm, chi2\n\n# 1. 랜덤 시드 설정 (재현 가능성 확보)\nnp.random.seed(2024)\n\n# 2. 정규분포의 평균과 표준편차 설정\nloc = 3     # 평균 (mean)\nscale = 2   # 표준편차 (standard deviation)\n\n# 3. 샘플의 크기와 샘플링 횟수 설정\nn = 20             # 각 샘플의 크기 (샘플당 20개 데이터)\nnum_samples = 500  # 샘플링 횟수 (총 500개의 샘플 생성)\n\n# 4. 각 샘플의 분산을 저장할 리스트 초기화\nvar_samples = []\n\n# 5. 500개의 샘플을 생성하고 각 샘플의 분산을 계산하여 리스트에 저장\nfor i in range(num_samples):\n    # 평균 3, 표준편차 2인 정규분포에서 20개의 데이터 샘플링\n    x = norm.rvs(loc=loc, scale=scale, size=n)\n    \n    # 샘플에서 분산 계산 (ddof=1로 표본분산을 계산)\n    var_samples.append(np.var(x, ddof=1))\n\n# 6. 계산된 분산 값을 스케일링 (각 분산 값에 4.75를 곱함)\nscaled_var_samples = np.array(var_samples) * 4.75\n\n# 7. 스케일된 분산 값의 히스토그램 그리기\nplt.hist(scaled_var_samples, bins=50, density=True, color=\"lightblue\", edgecolor=\"black\")\nplt.xlabel(\"4.75 * s^2\")\nplt.ylabel(\"density\")\n \n ## density=False, 히스토그램의 막대는 각 구간에 속하는 데이터 개수\n ## density=True, 히스토그램의 막대 높이는 **해당 구간에 속하는 데이터의 비율(확률)\n ## 히스토그램의 전체 면적이 1이 되도록 막대의 높이가 조정>다른 크기의 샘플들과 비교하기 쉬워짐.\n\n# 8. 이론적인 카이제곱(χ²) 분포 그리기\nx = np.linspace(0, max(scaled_var_samples), 1000)  # x축 값 설정 (0에서 최대 분산 값까지)\npdf_chi19 = chi2.pdf(x, df=19)  # 자유도(df)가 19인 카이제곱 분포의 확률 밀도 함수\n\n# 9. 히스토그램 위에 카이제곱 분포를 파란 점선으로 그리기\nplt.plot(x, pdf_chi19, 'b--', linewidth=2)\n\n# 10. 범례 추가 (그래프 설명)\nplt.legend([\"histogram\", \"df 19 chisquare dist\"], loc=\"upper right\")\n\n# 11. 그래프 표시\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw7_files/figure-html/cell-16-output-1.png){width=597 height=429}\n:::\n:::\n\n\n",
    "supporting": [
      "hw7_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}